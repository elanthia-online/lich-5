release:
  runs-on: ubuntu-latest
  steps:
    - name: Checkout code
      uses: actions/checkout@v2
      with:
        fetch-depth: 0
    - name: Build changelog
      id: build_changelog
      uses: mikepenz/release-changelog-builder-action@main
      with:
        configuration: 'release-changelog-builder-config.json'
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
    - name: Install core scripts
      id: install_core_scripts
      run: |
        mkdir scripts/
        mkdir data/
        curl https://extras.repo.elanthia.online/assets/jinx.lic > scripts/jinx.lic
        curl https://extras.repo.elanthia.online/assets/infomon.lic > scripts/infomon.lic
        curl https://extras.repo.elanthia.online/assets/go2.lic > scripts/go2.lic
      
    - name: Create release
      id: create_release
      uses: actions/create-release@latest
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }} # This token is provided by Actions, you do not need to create your own token
      with:
        tag_name: ${{ github.ref }}
        release_name: Release ${{ github.ref }}
        body: ${{steps.build_changelog.outputs.changelog}}
        draft: true
        prerelease: false
